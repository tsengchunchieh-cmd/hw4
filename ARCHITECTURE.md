# ğŸ“ RAG ç³»çµ±æ¶æ§‹æ–‡æª”

## ç³»çµ±æ¦‚è¿°

æœ¬æ–‡æª”è©³ç´°æè¿° RAG æ–‡ä»¶å•ç­”ç³»çµ±çš„æ¶æ§‹ã€è¨­è¨ˆæ±ºç­–å’Œæ•¸æ“šæµã€‚

---

## ğŸ—ï¸ é«˜å±¤æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Streamlit Web Interface                   â”‚
â”‚  (streamlit_app.py)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ æ–‡ä»¶ä¸Šå‚³æ¨¡å¡Š  â”‚    â”‚ å•ç­”äº¤äº’æ¨¡å¡Š  â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                     â”‚
          â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Core Processing Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ vector_store.py  â”‚  â”‚  rag_chain.py    â”‚                â”‚
â”‚  â”‚ - æ–‡ä»¶è¼‰å…¥        â”‚  â”‚ - RAG æŸ¥è©¢ç®¡é“   â”‚                â”‚
â”‚  â”‚ - æ–‡æœ¬åˆ†å‰²        â”‚  â”‚ - LLM é›†æˆ       â”‚                â”‚
â”‚  â”‚ - FAISS å»ºç«‹      â”‚  â”‚ - æç¤ºè©æ¨¡æ¿     â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                      â”‚
            â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Model & Service Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  embeddings.py       â”‚  â”‚ Google Gemini 2.5      â”‚       â”‚
â”‚  â”‚  EmbeddingGemma      â”‚  â”‚ Flash API              â”‚       â”‚
â”‚  â”‚  (google/embedding   â”‚  â”‚                        â”‚       â”‚
â”‚  â”‚   gemma-300m)        â”‚  â”‚ (LLM for generation)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                          â”‚
              â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              External Services                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ HuggingFace Model    â”‚  â”‚ Google Cloud APIs      â”‚       â”‚
â”‚  â”‚ (EmbeddingGemma)     â”‚  â”‚ (Gemini, LLM)          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š æ•¸æ“šæµ

### 1. æ–‡ä»¶è™•ç†æµç¨‹

```
ä¸Šå‚³æ–‡ä»¶
   â”‚
   â–¼
ä¿å­˜åˆ°è‡¨æ™‚ç›®éŒ„
   â”‚
   â–¼
æŒ‰æ ¼å¼è¼‰å…¥ (PDF/DOCX/TXT)
   â”‚
   â”œâ”€ PDF â”€â”€â–¶ PyPDFLoader
   â”œâ”€ DOCX â”€â”€â–¶ UnstructuredWordDocumentLoader
   â””â”€ TXT â”€â”€â–¶ TextLoader
   â”‚
   â–¼
æå–æ–‡æœ¬å…§å®¹
   â”‚
   â–¼
éæ­¸å­—ç¬¦åˆ†å‰²
   â”œâ”€ chunk_size: 500
   â””â”€ chunk_overlap: 100
   â”‚
   â–¼
å‘é‡åŒ–ï¼ˆEmbeddingGemmaï¼‰
   â”‚
   â”œâ”€ æ–‡ä»¶å‰ç¶´: "title: none | text: {text}"
   â””â”€ è¿”å›: å‘é‡ (embedding)
   â”‚
   â–¼
FAISS ç´¢å¼•å»ºç«‹
   â”‚
   â–¼
ä¿å­˜åˆ°æœ¬åœ° (faiss_db/)
```

### 2. æŸ¥è©¢æµç¨‹

```
ä½¿ç”¨è€…æå•
   â”‚
   â–¼
æŸ¥è©¢å‘é‡åŒ–
   â””â”€ å‰ç¶´: "task: search result | query: {query}"
   â”‚
   â–¼
FAISS ç›¸ä¼¼æ€§æœç´¢
   â”œâ”€ k: 4 (æª¢ç´¢ 4 å€‹æœ€ç›¸é—œçš„æ–‡ä»¶)
   â””â”€ è¿”å›: æœ€ç›¸é—œçš„æ–‡ä»¶ç‰‡æ®µ
   â”‚
   â–¼
æ ¼å¼åŒ–ä¸Šä¸‹æ–‡
   â””â”€ ç”¨ "---" åˆ†éš”å¤šå€‹æ–‡ä»¶
   â”‚
   â–¼
æ§‹å»ºæç¤ºè©
   â”œâ”€ ç³»çµ±: RAG ç³»çµ±æç¤ºè©
   â”œâ”€ ç”¨æˆ¶: æå• + ä¸Šä¸‹æ–‡
   â””â”€ æ¨¡æ¿: è¦‹ config.py
   â”‚
   â–¼
Gemini 2.5 Flash ç”Ÿæˆ
   â”œâ”€ æº«åº¦: 0.0 (ç¢ºå®šæ€§)
   â””â”€ è¿”å›: ç­”æ¡ˆæ–‡æœ¬
   â”‚
   â–¼
è¿”å›çµ¦ä½¿ç”¨è€…
   â”œâ”€ æœ€çµ‚ç­”æ¡ˆ
   â””â”€ æª¢ç´¢åˆ°çš„ä¾†æºæ–‡ä»¶
```

---

## ğŸ”Œ æ¨¡å¡Šè¨­è¨ˆ

### embeddings.py
**è²¬ä»»**: è‡ªå®šç¾©å‘é‡åŒ–

```python
class EmbeddingGemmaEmbeddings(HuggingFaceEmbeddings):
    - embed_documents(): å‘é‡åŒ–æ–‡ä»¶
    - embed_query(): å‘é‡åŒ–æŸ¥è©¢
```

**è¨­è¨ˆæ±ºç­–**:
- éµå¾ª Google æ¨è–¦çš„å‰ç¶´æ ¼å¼
- è¦ç¯„åŒ–åµŒå…¥å‘é‡
- CPU å„ªåŒ–ï¼ˆæ”¯æŒ GPUï¼‰

### rag_chain.py
**è²¬ä»»**: RAG æŸ¥è©¢ç®¡é“

```python
def query_rag(vectorstore, query, llm_api_key):
    - åˆå§‹åŒ– Gemini LLM
    - å»ºç«‹æª¢ç´¢å™¨
    - æ ¼å¼åŒ–ä¸Šä¸‹æ–‡
    - æ§‹å»º LangChain RAG Chain
    - åŸ·è¡ŒæŸ¥è©¢
    - è¿”å›ç­”æ¡ˆ + æ–‡ä»¶
```

**è¨­è¨ˆæ±ºç­–**:
- æº«åº¦è¨­ç‚º 0.0 ç¢ºä¿ç­”æ¡ˆä¸€è‡´æ€§
- k=4 å¹³è¡¡æª¢ç´¢é€Ÿåº¦å’Œè³ªé‡
- ä½¿ç”¨ LangChain ç°¡åŒ–ç®¡é“

### vector_store.py
**è²¬ä»»**: å‘é‡è³‡æ–™åº«ç®¡ç†

```python
def create_vector_store(uploaded_files, hf_token):
    - è¼‰å…¥å¤šæ ¼å¼æ–‡ä»¶
    - åˆ†å‰²æ–‡æœ¬
    - å»ºç«‹ FAISS ç´¢å¼•

def save_vectorstore(vectorstore, path):
    - ä¿å­˜åˆ°æœ¬åœ°

def load_vectorstore(path):
    - å¾æœ¬åœ°è¼‰å…¥
```

**è¨­è¨ˆæ±ºç­–**:
- æ”¯æŒå¤šæ–‡ä»¶æ ¼å¼
- è‡ªå‹•æ¸…ç†è‡¨æ™‚æ–‡ä»¶
- æŒä¹…åŒ–å­˜å„²

### config.py
**è²¬ä»»**: é…ç½®ç®¡ç†

```
- API å¯†é‘°ç®¡ç†
- æ¨¡å‹åƒæ•¸
- æ–‡æœ¬è™•ç†åƒæ•¸
- éŒ¯èª¤æ¶ˆæ¯
- é…ç½®é©—è­‰
```

**è¨­è¨ˆæ±ºç­–**:
- ç’°å¢ƒè®Šæ•¸å„ªå…ˆ
- åˆç†çš„é»˜èªå€¼
- é›†ä¸­åŒ–é…ç½®

### streamlit_app.py
**è²¬ä»»**: ç”¨æˆ¶ç•Œé¢

```
æ¨™ç±¤ 1: å»ºç«‹è³‡æ–™åº«
  - æ–‡ä»¶ä¸Šå‚³
  - è³‡æ–™åº«å»ºç«‹
  - è³‡æ–™åº«ä¿å­˜/è¼‰å…¥

æ¨™ç±¤ 2: æå•
  - æŸ¥è©¢è¼¸å…¥
  - ç­”æ¡ˆé¡¯ç¤º
  - æ–‡ä»¶ç‰‡æ®µå±•ç¤º
```

**è¨­è¨ˆæ±ºç­–**:
- å…©æ¨™ç±¤åˆ†é›¢è·è²¬
- å´é‚Šæ¬„é›†ä¸­é…ç½®
- å¯¦æ™‚åé¥‹æç¤º

---

## ğŸ” å®‰å…¨è€ƒæ…®

### API å¯†é‘°ç®¡ç†
```
.env (æœ¬åœ°)
  â”œâ”€ æœªæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
  â”œâ”€ .gitignore é˜²è­·
  â””â”€ åƒ…åœ¨é‹è¡Œæ™‚è¼‰å…¥
```

### æ–‡ä»¶è™•ç†
```
ä¸Šå‚³æ–‡ä»¶
  â”œâ”€ è‡¨æ™‚å­˜å„²
  â”œâ”€ è‡ªå‹•æ¸…ç†
  â””â”€ æ”¯æŒçš„æ ¼å¼é©—è­‰
```

### æ¨¡å‹å®‰å…¨
```
- æº«åº¦è¨­ç‚º 0.0 (ç¢ºå®šæ€§)
- æ²’æœ‰æ–‡ä»¶çš„ç­”æ¡ˆè¢«æ‹’çµ•
- è¼¸å…¥é©—è­‰
```

---

## âš™ï¸ æ€§èƒ½ç‰¹æ€§

### å‘é‡åŒ–æ€§èƒ½
- **æ¨¡å‹**: EmbeddingGemma-300m (è¼•é‡ç´š)
- **ç¶­åº¦**: 300D
- **è¦ç¯„åŒ–**: True (åŠ é€Ÿç›¸ä¼¼æ€§æœç´¢)

### æª¢ç´¢æ€§èƒ½
- **ç´¢å¼•**: FAISS (IVF)
- **æ™‚é–“è¤‡é›œåº¦**: O(log n)
- **æª¢ç´¢çµæœ**: Top-4

### ç”Ÿæˆæ€§èƒ½
- **æ¨¡å‹**: Gemini 2.5 Flash (å¿«é€Ÿ)
- **æº«åº¦**: 0.0 (ç¢ºå®šæ€§)
- **ä¸Šä¸‹æ–‡çª—å£**: æ”¯æŒé•·æ–‡æœ¬

---

## ğŸ“ˆ å¯æ“´å±•æ€§è¨­è¨ˆ

### æ°´å¹³æ“´å±•
```
- å¤šå€‹è³‡æ–™åº«æ”¯æŒ
- æ‰¹é‡æ–‡ä»¶è™•ç†
- ä¸¦è¡ŒæŸ¥è©¢
```

### å‚ç›´æ“´å±•
```
- GPU åŠ é€Ÿ (é…ç½® device="cuda")
- æ›´å¤§çš„ chunk_size
- å¢åŠ  k å€¼
```

### åŠŸèƒ½æ“´å±•
```
- å°è©±è¨˜æ†¶
- æ–‡ä»¶ç®¡ç†
- æ€§èƒ½æŒ‡æ¨™
- ä½¿ç”¨è€…ç®¡ç†
```

---

## ğŸ”„ é…ç½®æµç¨‹

```
æ‡‰ç”¨å•Ÿå‹•
   â”‚
   â–¼
è¼‰å…¥ .env æ–‡ä»¶
   â”‚
   â–¼
åˆå§‹åŒ–é…ç½®
   â”œâ”€ é©—è­‰ API å¯†é‘°
   â”œâ”€ è¨­å®šæ¨¡å‹åƒæ•¸
   â””â”€ æº–å‚™ç›®éŒ„
   â”‚
   â–¼
æª¢æŸ¥ä¾è³´
   â”‚
   â–¼
å•Ÿå‹• Streamlit æ‡‰ç”¨
```

---

## ğŸ§ª æ¸¬è©¦æ¶æ§‹

```
test_rag.py
â”œâ”€ test_file_structure()      # æ–‡ä»¶çµæ§‹
â”œâ”€ test_config()              # é…ç½®åŠ è¼‰
â”œâ”€ test_embeddings()          # åµŒå…¥æ¨¡å‹
â”œâ”€ test_rag_chain()           # RAG ç®¡é“
â”œâ”€ test_vector_store()        # å‘é‡è³‡æ–™åº«
â””â”€ test_api_keys()            # API å¯†é‘°
```

---

## ğŸ“‹ ä¾è³´é—œä¿‚

```
streamlit_app.py
â”œâ”€ config.py
â”œâ”€ embeddings.py
â”‚  â””â”€ sentence-transformers
â”œâ”€ rag_chain.py
â”‚  â”œâ”€ langchain
â”‚  â””â”€ langchain-google-genai
â””â”€ vector_store.py
   â”œâ”€ langchain-community
   â”œâ”€ faiss-cpu
   â”œâ”€ pypdf
   â”œâ”€ python-docx
   â””â”€ unstructured
```

---

## ğŸ” ç›£æ§èˆ‡æ—¥èªŒ

### ä¿¡æ¯æµ
```
æ‡‰ç”¨å±¤
   â–¼
é…ç½®å±¤
   â–¼
æ¨¡å‹å±¤
   â–¼
å¤–éƒ¨ API
```

### å¯è§€æ¸¬æ€§
- Streamlit å…§ç½®æ—¥èªŒ
- è‡ªå®šç¾©é€²åº¦æç¤º
- éŒ¯èª¤æ¶ˆæ¯æœ¬åœ°åŒ–

---

## ğŸš€ éƒ¨ç½²è€ƒæ…®

### æœ¬åœ°éƒ¨ç½²
```
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
streamlit run streamlit_app.py
```

### é›²ç«¯éƒ¨ç½² (Streamlit Cloud)
```
1. æ¨é€åˆ° GitHub
2. é€£æ¥ Streamlit Cloud
3. é…ç½® secrets
4. éƒ¨ç½²
```

### Docker éƒ¨ç½²
```dockerfile
FROM python:3.10
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["streamlit", "run", "streamlit_app.py"]
```

---

## ğŸ“š åƒè€ƒè³‡æº

- [LangChain æ–‡æª”](https://python.langchain.com/)
- [Streamlit æ–‡æª”](https://docs.streamlit.io/)
- [FAISS æ–‡æª”](https://faiss.ai/)
- [Google Gemini API](https://ai.google.dev/)
- [HuggingFace Transformers](https://huggingface.co/docs/transformers)

---

**æœ€å¾Œæ›´æ–°**: 2025-12-01  
**ç‰ˆæœ¬**: 1.0.0
